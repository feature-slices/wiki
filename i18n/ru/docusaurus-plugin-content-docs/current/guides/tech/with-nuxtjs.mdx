---
sidebar_position: 10
---
# Использование с NuxtJS

В NuxtJS проекте возможно реализовать FSD, однако возникают конфликты из-за различий между требованиями к структуре проекта NuxtJS и принципами FSD:

- Изначально, NuxtJS предлагает файловую структуру проекта без папки `src`, то есть в корне проекта.
- Файловый роутинг находится в папке `pages`, а в FSD эта папка отведена под плоскую структуру слайсов.
- Автоимпорты работают для всех компонентов, в то время как FSD пропагандирует концепцию Public API (делится только необходимым из index файлов).

Но NuxtJS обладает довольно гибкой настройкой конфигурации, что поможет нам полноценно внедрить в него FSD, не теряя его основных достоинств со стороны разработки:

- Автоимпорты.
- Файловый роутинг.

## Автоимпорты

На первый взгляд автоимпорты противоречат концепции Public Api и FSD, т.к. создает импорты для всех компонентов, но этого можно избежать, правильно настроив конфигурацию.

### Компоненты

По умолчанию в NuxtJS для компонентов выделена дирректория `components/`.

Дирректории для компонентов можно переопределить настройкой `components`.

#### shared

```ts
components: {
  dirs: [
    {
      path: "~/src/shared", // shared дирректория
      pattern: "**/*index.vue", // Файл для автоимпорта
      extensions: ["vue"],
    },
  ];
}
```

#### entities

```ts
components: {
  dirs: [
    {
      path: "~/src/entities", // entities дирректория
      extendComponent(component) {
        component.pascalName = component.pascalName.replaceAll("Ui", ""); // Убираем Ui дирректории из имени компонента
        return component;
      },
      pattern: "**/*index.vue", // Файл для автоимпорта
      extensions: ["vue"],
    },
  ];
}
```

#### features

```ts
components: {
  dirs: [
    {
      path: "~/src/features", // features дирректория
      extendComponent(component) {
        component.pascalName = component.pascalName.replaceAll("Ui", ""); // Убираем Ui дирректории из имени компонента
        component.pascalName = component.pascalName + "Feature"; // Добавляем Feature постфикс
        return component;
      },
      pattern: "**/*index.vue", // Файл для автоимпорта
      extensions: ["vue"],
    },
  ];
}
```

#### widgets

```ts
components: {
  dirs: [
    {
      path: "~/src/widgets", // widgets дирректория
      extendComponent(component) {
        component.pascalName = component.pascalName.replaceAll("Ui", ""); // Убираем Ui дирректории из имени компонента
        component.pascalName = component.pascalName + "Widget"; // Добавляем Widget постфикс
        return component;
      },
      pattern: "**/*index.vue", // Файл для автоимпорта
      extensions: ["vue"],
    },
  ];
}
```

#### pages

```ts
components: {
  dirs: [
    {
      path: "~/src/pages", // pages дирректория
      pattern: "**/*index.vue", // Файл для автоимпорта
      extensions: ["vue"],
    },
  ];
}
```

### Типы, функции и т.п.

По умолчанию в NuxtJS для этого выделена дирректория `utils/` и т.п.

Такие дирректории можно переопределить настройкой `imports`.

```ts
imports: {
  dirs: [
    "./src/widgets/*/*/index.ts", // Автоимпорты для widgets слоя
    "./src/features/*/*/index.ts", // Автоимпорты для features слоя
    "./src/entities/*/*/index.ts", // Автоимпорты для entities слоя
    "./src/shared/*/index.ts", // Автоимпорты для shared слоя
  ],
}
```

### Использование

1. Создайте `src` дирректорию.
2. Добавьте в `src` дирректорию FSD слои.

```bash
.../
├── src/
│   ├── app/
│   ├── entities/
│   ├── features/
│   ├── shared/
│   ├── widgets/
```

#### shared

Рассмотрим компонент `UiButton` для примера.

##### Структурв папок

```bash
.../
├── src/
│   ├── shared/
│   │   ├── ui/
│   │   │   ├── button/
│   │   │   │   ├── interfaces/
│   │   │   │   │   ├── ...
│   │   │   │   ├── index.ts # Для автоимпортов типов компонента
│   │   │   │   ├── index.vue # Для автоимпорта компонента
│   │   ├── utils/ # Любой сегмент
│   │   │   ├── sum.ts
│   │   │   ├── index.ts # Для автоимпорта функции и т.п. сегмента
```

`ui/button/index.ts` - файл для автоимпорта типов компонента.

```ts
export type { IUiButtonProps } from "./interfaces";
```

`ui/button/index.vue` - файл для автоимпорта компонента.

```vue
<script setup lang="ts">
import type { IUiButtonProps } from "./interfaces";

const props = withDefaults(defineProps<IUiButtonProps>(), {
  type: "button",
});
</script>

<template>
  <button :type="type">
    <slot />
  </button>
</template>
```

`utils/index.ts` - файл для автоимпорта функции и т.п. сегмента.

```ts
export { sum } from "./sum";
```

##### Использование

```vue
<script setup lang="ts">
const props: IUiButtonProps = {
  type: "submit",
};
</script>

<template>
  <UiButton v-bind="props"> Total: {{ sum(1, 4) }} </UiButton>
</template>
```

#### entities

Все также, как с `shared`, но компоненты не имеют `Ui` префикса и в структуру папок добавляется папка `слайса`.

#### features, widgets

Все также, как с `entities`, но компоненты имеют `Feature` и `Widget` постфикс.

#### pages

```bash
.../
├── src/
│   ├── pages/
│   │   ├── product/ # Любая страница
│   │   │   ├── index.vue # Для автоимпорта компонента страницы
```

## Роутинг, шаблоны, middleware

Необходимо переопределить дирректории по умолчанию.

```ts
dir: {
  pages: "./src/app/routes", // Роутинг
  layouts: "./src/app/layouts", // Шаблоны
  middleware: "./src/app/middlewares", // middlewares
},
```

### app

```bash
.../
├── src/
│   ├── app/
│   │   ├── routes/ # Роуты приложения
│   │   │   ├── index.vue # Роут для пути "/"
│   │   ├── middlewares/ # Middleware приложения
│   │   │   ├── auth.ts # Middleware авторизации
│   │   ├── layouts/ # Шаблоны приложения
│   │   │   ├── default.vue # Шаблон приложения по умолчанию
```

## Хочешь начать быстрее

Чтобы не настраивать все вручную, можно использовать модуль, который автоматически меняет конфигурацию.

[@dand.dev/nuxt-fsd](https://www.npmjs.com/package/@dand.dev/nuxt-fsd)
